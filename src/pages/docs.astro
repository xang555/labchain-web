---
import Layout from '../layouts/Layout.astro';

const sections = [
  { id: 'overview', label: 'Overview' },
  { id: 'prerequisites', label: 'Prerequisites' },
  { id: 'el-node', label: 'Execution Layer Node' },
  { id: 'beacon-node', label: 'Beacon Node' },
  { id: 'validator-node', label: 'Validator Node' },
  { id: 'exiting-validators', label: 'Exiting Validators' },
  { id: 'bootnode-info', label: 'Bootnode Information' },
  { id: 'commands', label: 'Node Commands' },
];
---

<Layout title="Documentation - LAB Chain" description="Complete documentation for running LAB Chain nodes. Learn how to set up Execution Layer, Beacon, and Validator nodes.">
  <div class="docs-layout">
    <!-- Mobile Sidebar Toggle -->
    <button class="docs-mobile-toggle" id="docsSidebarToggle" aria-label="Toggle documentation menu">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
      <span>Menu</span>
    </button>

    <!-- Sidebar Overlay -->
    <div class="docs-sidebar-overlay" id="docsSidebarOverlay"></div>

    <!-- Sidebar -->
    <aside class="docs-sidebar" id="docsSidebar">
      <div class="sidebar-content">
        <div class="sidebar-header-mobile">
          <h3>Documentation</h3>
          <button class="sidebar-close-btn" id="docsSidebarClose" aria-label="Close menu">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
        <h3 class="sidebar-title-desktop">Documentation</h3>
        <nav class="sidebar-nav">
          {sections.map((section) => (
            <a href={`#${section.id}`} class="sidebar-link">
              {section.label}
            </a>
          ))}
        </nav>
        <div class="sidebar-cta">
          <a href="https://github.com/AIDappLab/labchain" class="btn btn-secondary btn-sm" target="_blank" rel="noopener noreferrer">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
            </svg>
            View on GitHub
          </a>
        </div>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="docs-main">
      <div class="docs-content">
        <!-- Header -->
        <div class="docs-header">
          <div class="breadcrumb">
            <a href="/">Home</a>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
            <span>Documentation</span>
          </div>
          <h1>LAB Chain Documentation</h1>
          <p class="docs-intro">
            Complete guide to running nodes on the LAB Chain network. Learn how to set up and operate
            Execution Layer nodes, Beacon nodes, and Validator nodes.
          </p>
        </div>

        <!-- Overview Section -->
        <section id="overview" class="docs-section">
          <h2>Overview</h2>
          <p>
            LAB Chain is a Proof-of-Stake Ethereum-compatible network. The network consists of three main node types:
          </p>

          <div class="node-types-grid">
            <div class="node-type-card">
              <div class="node-type-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                  <line x1="8" y1="21" x2="16" y2="21"></line>
                  <line x1="12" y1="17" x2="12" y2="21"></line>
                </svg>
              </div>
              <h4>Full Node</h4>
              <p>Runs both Execution Layer (EL) and Consensus Layer (CL). Best for full network participation.</p>
            </div>
            <div class="node-type-card">
              <div class="node-type-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polygon points="12 2 2 7 12 12 22 7 12 2"></polygon>
                  <polyline points="2 17 12 22 22 17"></polyline>
                  <polyline points="2 12 12 17 22 12"></polyline>
                </svg>
              </div>
              <h4>Beacon Node</h4>
              <p>Runs CL only, requires external EL access. Ideal for consensus layer participation.</p>
            </div>
            <div class="node-type-card">
              <div class="node-type-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                </svg>
              </div>
              <h4>Validator Node</h4>
              <p>Runs Validator Client (VC) only, requires external Beacon Node. For staking and earning rewards.</p>
            </div>
          </div>

          <div class="info-box">
            <h4>Components Used</h4>
            <ul>
              <li><strong>Execution Layer (EL):</strong> Reth - handles transactions and smart contract processing</li>
              <li><strong>Consensus Layer (CL):</strong> Lighthouse Beacon Node - manages PoS consensus</li>
              <li><strong>Validator Client (VC):</strong> Lighthouse VC - handles block proposals and attestations</li>
            </ul>
          </div>

          <h3>Network Parameters</h3>
          <div class="params-table">
            <table>
              <thead>
                <tr>
                  <th>Parameter</th>
                  <th>Value</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Chain ID</td>
                  <td><code>5222</code></td>
                </tr>
                <tr>
                  <td>Slot Duration</td>
                  <td><code>12 seconds</code></td>
                </tr>
                <tr>
                  <td>Deposit Contract</td>
                  <td><code>0x5454545454545454545454545454545454545454</code></td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>

        <!-- Prerequisites Section -->
        <section id="prerequisites" class="docs-section">
          <h2>Prerequisites</h2>

          <h3>Software Requirements</h3>
          <ol class="requirements-list">
            <li>
              <strong>Docker & Docker Compose</strong>
              <p>Install via the official Docker script:</p>
              <div class="code-block">
                <code>curl -fsSL https://get.docker.com | sh</code>
                <button class="copy-btn" data-copy="curl -fsSL https://get.docker.com | sh">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                  </svg>
                </button>
              </div>
            </li>
            <li>
              <strong>Foundry</strong> (validators only)
              <p>Required for the <code>cast</code> tool to broadcast deposit transactions:</p>
              <div class="code-block">
                <code>curl -L https://foundry.paradigm.xyz | bash && foundryup</code>
                <button class="copy-btn" data-copy="curl -L https://foundry.paradigm.xyz | bash && foundryup">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                  </svg>
                </button>
              </div>
            </li>
            <li>
              <strong>jq</strong> (validators only)
              <p>JSON processor for handling validator data:</p>
              <div class="code-block">
                <code># Ubuntu/Debian
sudo apt-get install jq

# macOS
brew install jq</code>
                <button class="copy-btn" data-copy="sudo apt-get install jq">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                  </svg>
                </button>
              </div>
            </li>
          </ol>

          <h3>Hardware Requirements</h3>
          <div class="requirements-grid">
            <div class="requirement-card">
              <span class="req-label">CPU</span>
              <span class="req-value">4+ cores</span>
            </div>
            <div class="requirement-card">
              <span class="req-label">RAM</span>
              <span class="req-value">8GB minimum</span>
            </div>
            <div class="requirement-card">
              <span class="req-label">Storage</span>
              <span class="req-value">100GB SSD</span>
            </div>
          </div>

          <h3>Network Ports</h3>
          <div class="params-table">
            <table>
              <thead>
                <tr>
                  <th>Port</th>
                  <th>Protocol</th>
                  <th>Purpose</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><code>30303</code></td>
                  <td>TCP/UDP</td>
                  <td>Execution Layer P2P</td>
                </tr>
                <tr>
                  <td><code>9000</code></td>
                  <td>TCP/UDP</td>
                  <td>Consensus Layer P2P</td>
                </tr>
              </tbody>
            </table>
          </div>

          <h3>Initial Setup</h3>
          <ol class="setup-steps">
            <li>
              <strong>Clone the repository</strong>
              <div class="code-block">
                <code>git clone https://github.com/AIDappLab/labchain.git && cd labchain</code>
                <button class="copy-btn" data-copy="git clone https://github.com/AIDappLab/labchain.git && cd labchain">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                  </svg>
                </button>
              </div>
            </li>
            <li>
              <strong>Create Docker network</strong>
              <div class="code-block">
                <code>docker network create labchain-net</code>
                <button class="copy-btn" data-copy="docker network create labchain-net">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                  </svg>
                </button>
              </div>
            </li>
            <li>
              <strong>Generate JWT secret</strong>
              <p>Required for EL/CL communication:</p>
              <div class="code-block">
                <code>openssl rand -hex 32 > jwt.hex</code>
                <button class="copy-btn" data-copy="openssl rand -hex 32 > jwt.hex">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                  </svg>
                </button>
              </div>
            </li>
          </ol>
        </section>

        <!-- EL Node Section -->
        <section id="el-node" class="docs-section">
          <h2>Execution Layer (EL) Node</h2>
          <p>
            The Execution Layer handles all transaction processing and smart contract execution.
            LAB Chain uses <strong>Reth</strong> as the EL client.
          </p>

          <h3>Default Ports</h3>
          <div class="params-table">
            <table>
              <thead>
                <tr>
                  <th>Port</th>
                  <th>Purpose</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><code>8545</code></td>
                  <td>HTTP RPC</td>
                </tr>
                <tr>
                  <td><code>8546</code></td>
                  <td>WebSocket RPC</td>
                </tr>
                <tr>
                  <td><code>8551</code></td>
                  <td>Auth RPC (Engine API)</td>
                </tr>
                <tr>
                  <td><code>30303</code></td>
                  <td>P2P Discovery</td>
                </tr>
              </tbody>
            </table>
          </div>

          <h3>Setup Instructions</h3>
          <ol class="setup-steps">
            <li>
              <strong>Initialize the EL node</strong>
              <div class="code-block">
                <code>./node.sh init el</code>
                <button class="copy-btn" data-copy="./node.sh init el">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                  </svg>
                </button>
              </div>
              <p>This will guide you through interactive configuration.</p>
            </li>
            <li>
              <strong>Start the EL node</strong>
              <div class="code-block">
                <code>./node.sh start el</code>
                <button class="copy-btn" data-copy="./node.sh start el">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                  </svg>
                </button>
              </div>
            </li>
            <li>
              <strong>Verify sync status</strong>
              <div class="code-block">
                <code>curl http://localhost:8545 -X POST -H "Content-Type: application/json" -d '&#123;"jsonrpc":"2.0","method":"eth_syncing","params":[],"id":1&#125;'</code>
                <button class="copy-btn" data-copy="curl http://localhost:8545 -X POST -H 'Content-Type: application/json' -d '{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;eth_syncing&quot;,&quot;params&quot;:[],&quot;id&quot;:1}'">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                  </svg>
                </button>
              </div>
              <p>Returns <code>false</code> when fully synced.</p>
            </li>
          </ol>
        </section>

        <!-- Beacon Node Section -->
        <section id="beacon-node" class="docs-section">
          <h2>Beacon Node (Consensus Layer)</h2>
          <p>
            The Beacon Node manages the Proof-of-Stake consensus mechanism.
            LAB Chain uses <strong>Lighthouse</strong> as the CL client.
          </p>

          <h3>Default Ports</h3>
          <div class="params-table">
            <table>
              <thead>
                <tr>
                  <th>Port</th>
                  <th>Purpose</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><code>5052</code></td>
                  <td>Beacon API (HTTP)</td>
                </tr>
                <tr>
                  <td><code>9000</code></td>
                  <td>P2P Discovery</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="info-box warning">
            <h4>Important</h4>
            <p>The Beacon Node requires a running Execution Layer node. It connects to the EL at <code>http://reth-node:8551</code> by default.</p>
          </div>

          <h3>Setup Instructions</h3>
          <ol class="setup-steps">
            <li>
              <strong>Initialize the CL node</strong>
              <div class="code-block">
                <code>./node.sh init cl</code>
                <button class="copy-btn" data-copy="./node.sh init cl">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                  </svg>
                </button>
              </div>
            </li>
            <li>
              <strong>Start the Beacon node</strong>
              <div class="code-block">
                <code>./node.sh start cl</code>
                <button class="copy-btn" data-copy="./node.sh start cl">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                  </svg>
                </button>
              </div>
            </li>
            <li>
              <strong>Verify sync status</strong>
              <div class="code-block">
                <code>curl http://localhost:5052/eth/v1/node/syncing</code>
                <button class="copy-btn" data-copy="curl http://localhost:5052/eth/v1/node/syncing">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                  </svg>
                </button>
              </div>
            </li>
          </ol>

          <h3>Running Both EL and CL</h3>
          <p>To run a full node with both layers:</p>
          <div class="code-block">
            <code>./node.sh start all</code>
            <button class="copy-btn" data-copy="./node.sh start all">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
              </svg>
            </button>
          </div>
        </section>

        <!-- Validator Node Section -->
        <section id="validator-node" class="docs-section">
          <h2>Validator Node</h2>
          <p>
            Validators participate in block production and attestation, earning rewards for securing the network.
            Each validator requires a <strong>32 LAB</strong> stake.
          </p>

          <div class="info-box success">
            <h4>Validator Requirements</h4>
            <ul>
              <li>Running Beacon Node (local or remote)</li>
              <li>32 LAB per validator</li>
              <li>Validator keystores (generated from mnemonic)</li>
              <li>Withdrawal address for rewards</li>
            </ul>
          </div>

          <h3>Step 1: Generate Validator Keystores</h3>
          <p>Use the validator management script to generate keystores from your mnemonic:</p>
          <div class="code-block">
            <code>cd vc && ./manage-validators.sh --count 1 --withdrawal YOUR_LAB_ADDRESS</code>
            <button class="copy-btn" data-copy="cd vc && ./manage-validators.sh --count 1 --withdrawal YOUR_LAB_ADDRESS">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
              </svg>
            </button>
          </div>
          <p>Options:</p>
          <ul>
            <li><code>--count</code>: Number of validators to generate</li>
            <li><code>--withdrawal</code>: Your LAB address for receiving rewards</li>
          </ul>

          <h3>Step 2: Fund Your Validators</h3>
          <p>Each validator requires exactly 32 LAB. Use the deposit broadcast script:</p>
          <div class="code-block">
            <code>./broadcast-deposits.sh --rpc RPC_ENDPOINT --deposit-file deposit_data.json --private-key YOUR_PRIVATE_KEY</code>
            <button class="copy-btn" data-copy="./broadcast-deposits.sh --rpc RPC_ENDPOINT --deposit-file deposit_data.json --private-key YOUR_PRIVATE_KEY">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
              </svg>
            </button>
          </div>

          <div class="info-box warning">
            <h4>Activation Time</h4>
            <p>Validator activation takes approximately <strong>16-24 hours</strong> after the deposit transaction is confirmed.</p>
          </div>

          <h3>Step 3: Start Validator Client</h3>
          <ol class="setup-steps">
            <li>
              <strong>Initialize the validator client</strong>
              <div class="code-block">
                <code>./node.sh init vc</code>
                <button class="copy-btn" data-copy="./node.sh init vc">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                  </svg>
                </button>
              </div>
              <p>Configure your fee recipient address and keystore location.</p>
            </li>
            <li>
              <strong>Start the validator client</strong>
              <div class="code-block">
                <code>./node.sh start vc</code>
                <button class="copy-btn" data-copy="./node.sh start vc">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                  </svg>
                </button>
              </div>
            </li>
            <li>
              <strong>Check validator logs</strong>
              <div class="code-block">
                <code>./node.sh logs vc</code>
                <button class="copy-btn" data-copy="./node.sh logs vc">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                  </svg>
                </button>
              </div>
              <p>Look for "Enabled validator" and attestation messages to confirm successful operation.</p>
            </li>
          </ol>
        </section>

        <!-- Exiting Validators Section -->
        <section id="exiting-validators" class="docs-section">
          <h2>Exiting Validators</h2>
          <p>
            If you wish to stop validating and withdraw your stake, you can initiate a voluntary exit.
            The <code>./exit-validators.sh</code> script handles voluntary exits for your validators.
          </p>

          <div class="info-box warning">
            <h4>Warning: Irreversible Action</h4>
            <p>Voluntary exits are <strong>irreversible</strong>. Once initiated, you cannot resume validating with the same keys. Make sure you understand the implications before proceeding.</p>
          </div>

          <h3>Exit Process Timeline</h3>
          <div class="params-table">
            <table>
              <thead>
                <tr>
                  <th>Phase</th>
                  <th>Duration</th>
                  <th>Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Exit Queue</td>
                  <td>Variable</td>
                  <td>Depends on network exit queue length</td>
                </tr>
                <tr>
                  <td>Withdrawal Delay</td>
                  <td>~27 hours</td>
                  <td>256 epochs after exit is processed</td>
                </tr>
                <tr>
                  <td>Total Minimum</td>
                  <td>~54 hours</td>
                  <td>From exit initiation to withdrawal eligibility</td>
                </tr>
              </tbody>
            </table>
          </div>

          <h3>Initiating a Voluntary Exit</h3>
          <ol class="setup-steps">
            <li>
              <strong>Run the exit script</strong>
              <div class="code-block">
                <code>./exit-validators.sh</code>
                <button class="copy-btn" data-copy="./exit-validators.sh">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                  </svg>
                </button>
              </div>
              <p>Follow the interactive prompts to select validators for exit.</p>
            </li>
            <li>
              <strong>Confirm the exit</strong>
              <p>Review the validator public keys and confirm you want to proceed with the exit.</p>
            </li>
            <li>
              <strong>Wait for processing</strong>
              <p>Monitor the exit queue and withdrawal status through the beacon chain explorer.</p>
            </li>
          </ol>

          <h3>Withdrawal Credentials</h3>
          <p>Your withdrawal credentials determine how you receive your staked LAB after exiting:</p>
          <div class="params-table">
            <table>
              <thead>
                <tr>
                  <th>Type</th>
                  <th>Prefix</th>
                  <th>Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>BLS</td>
                  <td><code>0x00</code></td>
                  <td>Legacy credentials - requires update for automatic withdrawals</td>
                </tr>
                <tr>
                  <td>Execution</td>
                  <td><code>0x01</code></td>
                  <td>Automatic withdrawals enabled to your ETH address</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="info-box success">
            <h4>LAB Chain Uses 0x01 Credentials</h4>
            <p>LAB Chain validators use <code>0x01</code> execution withdrawal credentials by default. This means automatic withdrawals are enabled to your specified ETH address when you exit.</p>
          </div>
        </section>

        <!-- Bootnode Information Section -->
        <section id="bootnode-info" class="docs-section">
          <h2>Get Bootnode Information</h2>
          <p>
            If you're running a bootnode and need to share connection info with other nodes, use these commands to get the necessary addresses.
          </p>

          <h3>Get EL Bootnode Enode</h3>
          <p>Get the enode URL that other Execution Layer nodes can use to connect:</p>
          <div class="code-block">
            <code>cd EL && ./get-bootnode-enode.sh</code>
            <button class="copy-btn" data-copy="cd EL && ./get-bootnode-enode.sh">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
              </svg>
            </button>
          </div>
          <p>This returns the enode URL (e.g., <code>enode://abc123...@IP:30303</code>)</p>

          <h3>Get CL Bootnode ENR</h3>
          <p>Get the ENR record that other Consensus Layer nodes can use for peer discovery:</p>
          <div class="code-block">
            <code>cd CL && ./get-bootnode-enr.sh</code>
            <button class="copy-btn" data-copy="cd CL && ./get-bootnode-enr.sh">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
              </svg>
            </button>
          </div>
          <p>This returns the ENR record (e.g., <code>enr:-...</code>)</p>

          <h3>Get CL Bootnode libp2p Address</h3>
          <p>Get the libp2p multiaddr for nodes using libp2p discovery mode:</p>
          <div class="code-block">
            <code>curl -s http://localhost:5052/eth/v1/node/identity | jq -r '.data.p2p_addresses[0]'</code>
            <button class="copy-btn" data-copy="curl -s http://localhost:5052/eth/v1/node/identity | jq -r '.data.p2p_addresses[0]'">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
              </svg>
            </button>
          </div>
          <p>This returns the libp2p multiaddr (e.g., <code>/ip4/IP/tcp/9000/p2p/PEER_ID</code>)</p>

          <div class="info-box warning">
            <h4>Important: Replace IP Address</h4>
            <p>When sharing bootnode addresses with other operators, replace <code>IP</code> with your server's public IP address so they can connect to your node.</p>
          </div>
        </section>

        <!-- Commands Section -->
        <section id="commands" class="docs-section">
          <h2>Node Management Commands</h2>
          <p>The <code>./node.sh</code> script provides all necessary commands for managing your nodes.</p>

          <h3>Available Commands</h3>
          <div class="params-table">
            <table>
              <thead>
                <tr>
                  <th>Command</th>
                  <th>Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><code>init &lt;node&gt;</code></td>
                  <td>Interactive configuration wizard</td>
                </tr>
                <tr>
                  <td><code>start &lt;node&gt;</code></td>
                  <td>Start the specified node</td>
                </tr>
                <tr>
                  <td><code>stop &lt;node&gt;</code></td>
                  <td>Stop the specified node</td>
                </tr>
                <tr>
                  <td><code>restart &lt;node&gt;</code></td>
                  <td>Restart the specified node</td>
                </tr>
                <tr>
                  <td><code>logs &lt;node&gt;</code></td>
                  <td>View node logs</td>
                </tr>
                <tr>
                  <td><code>status</code></td>
                  <td>Show status of all nodes</td>
                </tr>
                <tr>
                  <td><code>health</code></td>
                  <td>Network health check</td>
                </tr>
              </tbody>
            </table>
          </div>

          <h3>Node Options</h3>
          <p>Replace <code>&lt;node&gt;</code> with one of the following:</p>
          <ul>
            <li><code>el</code> - Execution Layer (Reth)</li>
            <li><code>cl</code> - Consensus Layer (Lighthouse Beacon)</li>
            <li><code>vc</code> - Validator Client</li>
            <li><code>all</code> - All nodes</li>
          </ul>

          <h3>Examples</h3>
          <div class="code-block">
            <code># Start all nodes
./node.sh start all

# Check status
./node.sh status

# View EL logs
./node.sh logs el

# Restart beacon node
./node.sh restart cl</code>
          </div>
        </section>

        <!-- Footer Navigation -->
        <div class="docs-footer">
          <div class="docs-nav-cards">
            <a href="/boot-nodes" class="nav-card">
              <span class="nav-label">View Network</span>
              <span class="nav-title">Boot Nodes</span>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="5" y1="12" x2="19" y2="12"></line>
                <polyline points="12 5 19 12 12 19"></polyline>
              </svg>
            </a>
            <a href="/beacon-nodes" class="nav-card">
              <span class="nav-label">View Network</span>
              <span class="nav-title">Beacon Nodes</span>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="5" y1="12" x2="19" y2="12"></line>
                <polyline points="12 5 19 12 12 19"></polyline>
              </svg>
            </a>
          </div>
        </div>
      </div>
    </main>
  </div>
</Layout>

<style>
  .docs-layout {
    display: grid;
    grid-template-columns: 280px 1fr;
    min-height: calc(100vh - var(--header-height));
    width: 100%;
    max-width: 100vw;
    overflow-x: hidden;
  }

  /* Mobile Toggle Button - Hidden, using header menu instead */
  .docs-mobile-toggle {
    display: none !important;
  }

  /* Sidebar Overlay */
  .docs-sidebar-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: 200;
    opacity: 0;
    visibility: hidden;
    transition: all var(--transition-normal);
  }

  .docs-sidebar-overlay.open {
    opacity: 1;
    visibility: visible;
  }

  /* Mobile Sidebar Header */
  .sidebar-header-mobile {
    display: none;
    align-items: center;
    justify-content: space-between;
    padding-bottom: 16px;
    margin-bottom: 16px;
    border-bottom: 1px solid var(--border-color);
  }

  .sidebar-header-mobile h3 {
    font-size: 16px;
    font-weight: 600;
    color: var(--text-primary);
    margin: 0;
  }

  .sidebar-close-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
    border-radius: var(--radius-md);
    color: var(--text-secondary);
    background: transparent;
    border: none;
    cursor: pointer;
    transition: all var(--transition-fast);
  }

  .sidebar-close-btn:hover {
    background: var(--bg-tertiary);
    color: var(--text-primary);
  }

  /* Sidebar */
  .docs-sidebar {
    position: sticky;
    top: var(--header-height);
    height: calc(100vh - var(--header-height));
    border-right: 1px solid var(--border-color);
    background: var(--bg-secondary);
    overflow-y: auto;
    z-index: 50;
  }

  .sidebar-content {
    padding: 32px 24px;
  }

  .sidebar-title-desktop {
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--text-tertiary);
    margin-bottom: 16px;
  }

  .sidebar-nav {
    display: flex;
    flex-direction: column;
    gap: 4px;
  }

  .sidebar-link {
    display: block;
    padding: 10px 12px;
    font-size: 14px;
    color: var(--text-secondary);
    border-radius: var(--radius-md);
    transition: all var(--transition-fast);
  }

  .sidebar-link:hover {
    color: var(--text-primary);
    background: var(--bg-tertiary);
  }

  .sidebar-link.active {
    color: var(--color-red);
    background: rgba(206, 17, 38, 0.1);
  }

  .sidebar-cta {
    margin-top: 32px;
    padding-top: 24px;
    border-top: 1px solid var(--border-color);
  }

  .sidebar-cta .btn {
    width: 100%;
    justify-content: center;
  }

  /* Main Content */
  .docs-main {
    padding: 48px;
    max-width: 900px;
    min-width: 0;
    overflow-x: hidden;
  }

  .docs-content {
    max-width: 100%;
    overflow-x: hidden;
  }

  .docs-header {
    margin-bottom: 48px;
    padding-bottom: 32px;
    border-bottom: 1px solid var(--border-color);
  }

  .breadcrumb {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    color: var(--text-tertiary);
    margin-bottom: 16px;
  }

  .breadcrumb a {
    color: var(--text-secondary);
    transition: color var(--transition-fast);
  }

  .breadcrumb a:hover {
    color: var(--color-red);
  }

  .docs-header h1 {
    font-size: 2.5rem;
    margin-bottom: 16px;
  }

  .docs-intro {
    font-size: 18px;
    color: var(--text-secondary);
    line-height: 1.7;
  }

  /* Sections */
  .docs-section {
    margin-bottom: 64px;
    scroll-margin-top: calc(var(--header-height) + 32px);
  }

  .docs-section h2 {
    font-size: 1.75rem;
    margin-bottom: 16px;
    padding-bottom: 12px;
    border-bottom: 2px solid var(--color-red);
  }

  .docs-section h3 {
    font-size: 1.25rem;
    margin-top: 32px;
    margin-bottom: 16px;
  }

  .docs-section p {
    margin-bottom: 16px;
    line-height: 1.7;
  }

  .docs-section ul,
  .docs-section ol {
    margin-bottom: 16px;
    padding-left: 24px;
  }

  .docs-section li {
    margin-bottom: 8px;
    line-height: 1.6;
    color: var(--text-secondary);
  }

  .docs-section ul {
    list-style: disc;
  }

  .docs-section ol {
    list-style: decimal;
  }

  /* Node Types Grid */
  .node-types-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    margin: 24px 0;
  }

  .node-type-card {
    padding: 24px;
    background: var(--bg-card);
    border: 1px solid var(--border-color);
    border-radius: var(--radius-lg);
    text-align: center;
  }

  .node-type-icon {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 48px;
    height: 48px;
    background: var(--gradient-primary);
    color: white;
    border-radius: var(--radius-md);
    margin-bottom: 16px;
  }

  .node-type-card h4 {
    font-size: 16px;
    margin-bottom: 8px;
  }

  .node-type-card p {
    font-size: 13px;
    color: var(--text-tertiary);
    margin: 0;
  }

  /* Info Box */
  .info-box {
    padding: 20px 24px;
    background: var(--bg-tertiary);
    border-left: 4px solid var(--color-blue);
    border-radius: 0 var(--radius-md) var(--radius-md) 0;
    margin: 24px 0;
  }

  .info-box.warning {
    border-left-color: #EAB308;
    background: rgba(234, 179, 8, 0.1);
  }

  .info-box.success {
    border-left-color: #22C55E;
    background: rgba(34, 197, 94, 0.1);
  }

  .info-box h4 {
    font-size: 14px;
    margin-bottom: 12px;
  }

  .info-box ul {
    margin: 0;
    padding-left: 20px;
  }

  .info-box li {
    font-size: 14px;
  }

  .info-box p {
    font-size: 14px;
    margin: 0;
  }

  /* Tables */
  .params-table {
    margin: 20px 0;
    overflow-x: auto;
  }

  .params-table table {
    width: 100%;
    border-collapse: collapse;
    font-size: 14px;
  }

  .params-table th,
  .params-table td {
    padding: 12px 16px;
    text-align: left;
    border-bottom: 1px solid var(--border-color);
  }

  .params-table th {
    background: var(--bg-tertiary);
    font-weight: 600;
    color: var(--text-primary);
  }

  .params-table td {
    color: var(--text-secondary);
  }

  .params-table code {
    font-size: 13px;
    padding: 2px 6px;
    background: var(--bg-tertiary);
    border-radius: var(--radius-sm);
    color: var(--color-red);
  }

  /* Code Block */
  .code-block {
    position: relative;
    margin: 12px 0 20px;
    padding: 16px 48px 16px 16px;
    background: var(--bg-tertiary);
    border: 1px solid var(--border-color);
    border-radius: var(--radius-md);
    overflow-x: auto;
  }

  .code-block code {
    font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
    font-size: 13px;
    color: var(--text-primary);
    white-space: pre-wrap;
    word-break: break-all;
  }

  .code-block .copy-btn {
    position: absolute;
    top: 12px;
    right: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    color: var(--text-tertiary);
    background: var(--bg-card);
    border: 1px solid var(--border-color);
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
  }

  .code-block .copy-btn:hover {
    color: var(--color-red);
    border-color: var(--color-red);
  }

  /* Requirements */
  .requirements-list li {
    margin-bottom: 20px;
  }

  .requirements-list li strong {
    display: block;
    color: var(--text-primary);
    margin-bottom: 4px;
  }

  .requirements-list li p {
    margin: 4px 0;
    font-size: 14px;
  }

  .requirements-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 16px;
    margin: 20px 0;
  }

  .requirement-card {
    display: flex;
    flex-direction: column;
    gap: 4px;
    padding: 20px;
    background: var(--bg-card);
    border: 1px solid var(--border-color);
    border-radius: var(--radius-md);
    text-align: center;
  }

  .req-label {
    font-size: 12px;
    color: var(--text-tertiary);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .req-value {
    font-size: 18px;
    font-weight: 600;
    color: var(--text-primary);
  }

  /* Setup Steps */
  .setup-steps {
    counter-reset: step;
    list-style: none;
    padding: 0;
  }

  .setup-steps li {
    position: relative;
    padding-left: 48px;
    margin-bottom: 32px;
  }

  .setup-steps li::before {
    content: counter(step);
    counter-increment: step;
    position: absolute;
    left: 0;
    top: 0;
    width: 32px;
    height: 32px;
    background: var(--gradient-primary);
    color: white;
    font-size: 14px;
    font-weight: 600;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .setup-steps li strong {
    display: block;
    font-size: 16px;
    color: var(--text-primary);
    margin-bottom: 8px;
  }

  .setup-steps li p {
    font-size: 14px;
    margin: 8px 0;
  }

  /* Footer Navigation */
  .docs-footer {
    margin-top: 64px;
    padding-top: 32px;
    border-top: 1px solid var(--border-color);
  }

  .docs-nav-cards {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 20px;
  }

  .nav-card {
    display: flex;
    flex-direction: column;
    gap: 4px;
    padding: 24px;
    background: var(--bg-card);
    border: 1px solid var(--border-color);
    border-radius: var(--radius-lg);
    transition: all var(--transition-normal);
  }

  .nav-card:hover {
    border-color: var(--color-red);
    box-shadow: var(--shadow-lg);
  }

  .nav-card svg {
    margin-top: 8px;
    color: var(--color-red);
  }

  .nav-label {
    font-size: 12px;
    color: var(--text-tertiary);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .nav-title {
    font-size: 18px;
    font-weight: 600;
    color: var(--text-primary);
  }

  /* Responsive */
  @media (max-width: 1024px) {
    .docs-layout {
      display: block;
      width: 100%;
    }

    .docs-sidebar {
      display: none;
    }

    .docs-main {
      padding: 32px 24px;
      max-width: 100%;
    }

    .node-types-grid {
      grid-template-columns: 1fr;
    }

    .requirements-grid {
      grid-template-columns: 1fr;
    }

    .code-block {
      max-width: 100%;
    }

    .code-block code {
      font-size: 12px;
    }
  }

  @media (max-width: 640px) {
    .docs-layout {
      width: 100%;
      overflow-x: hidden;
    }

    .docs-header h1 {
      font-size: 1.75rem;
    }

    .docs-nav-cards {
      grid-template-columns: 1fr;
    }

    .docs-main {
      padding: 24px 16px;
      width: 100%;
      box-sizing: border-box;
    }

    .docs-content {
      width: 100%;
    }

    .code-block {
      padding: 12px 40px 12px 12px;
      margin-left: 0;
      margin-right: 0;
    }

    .code-block code {
      font-size: 11px;
    }

    .params-table {
      margin-left: -16px;
      margin-right: -16px;
      width: calc(100% + 32px);
    }

    .params-table table {
      font-size: 12px;
    }

    .params-table th,
    .params-table td {
      padding: 10px 12px;
    }

    .setup-steps li {
      padding-left: 40px;
    }
  }
</style>

<script>
  // Copy button functionality
  const copyButtons = document.querySelectorAll('.copy-btn');

  copyButtons.forEach(btn => {
    btn.addEventListener('click', async () => {
      const textToCopy = btn.getAttribute('data-copy');
      if (!textToCopy) return;

      try {
        await navigator.clipboard.writeText(textToCopy);

        const originalHTML = btn.innerHTML;
        btn.innerHTML = `
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="20 6 9 17 4 12"></polyline>
          </svg>
        `;
        btn.style.color = '#22C55E';
        btn.style.borderColor = '#22C55E';

        setTimeout(() => {
          btn.innerHTML = originalHTML;
          btn.style.color = '';
          btn.style.borderColor = '';
        }, 2000);
      } catch (err) {
        console.error('Failed to copy:', err);
      }
    });
  });

  // Active sidebar link
  const sections = document.querySelectorAll('.docs-section');
  const sidebarLinks = document.querySelectorAll('.sidebar-link');

  const observerOptions = {
    rootMargin: '-100px 0px -80% 0px'
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        sidebarLinks.forEach(link => link.classList.remove('active'));
        const activeLink = document.querySelector(`.sidebar-link[href="#${entry.target.id}"]`);
        activeLink?.classList.add('active');
      }
    });
  }, observerOptions);

  sections.forEach(section => observer.observe(section));

  // Mobile docs sidebar toggle
  const docsSidebarToggle = document.getElementById('docsSidebarToggle');
  const docsSidebar = document.getElementById('docsSidebar');
  const docsSidebarOverlay = document.getElementById('docsSidebarOverlay');
  const docsSidebarClose = document.getElementById('docsSidebarClose');

  function openDocsSidebar() {
    docsSidebar?.classList.add('open');
    docsSidebarOverlay?.classList.add('open');
    document.body.style.overflow = 'hidden';
  }

  function closeDocsSidebar() {
    docsSidebar?.classList.remove('open');
    docsSidebarOverlay?.classList.remove('open');
    document.body.style.overflow = '';
  }

  docsSidebarToggle?.addEventListener('click', openDocsSidebar);
  docsSidebarClose?.addEventListener('click', closeDocsSidebar);
  docsSidebarOverlay?.addEventListener('click', closeDocsSidebar);

  // Close sidebar when clicking a link
  sidebarLinks.forEach(link => {
    link.addEventListener('click', () => {
      if (window.innerWidth <= 1024) {
        closeDocsSidebar();
      }
    });
  });

  // Close on escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      closeDocsSidebar();
    }
  });

  // Handle window resize
  window.addEventListener('resize', () => {
    if (window.innerWidth > 1024) {
      closeDocsSidebar();
    }
  });
</script>
